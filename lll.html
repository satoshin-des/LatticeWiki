<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLL基底簡約</title>
    <style>
        @import url(style.css);
    </style>
    <script src="macros.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <div class="search-wrapper">
        <div class="search-input-group">
            <input type="text" id="wiki-search-input" placeholder="ページを検索..." autocomplete="off">
            <button id="wiki-search-button">検索</button>
        </div>

        <div id="search-results-container"></div>
    </div>
    <article class="wiki-content">
        <h1>LLL基底簡約</h1>
        <p>
            <b>LLL基底簡約</b>（<b>LLL lattice basis
                reduction</b>）とは，古典的な格子基底簡約アルゴリズムの一つであり，DeepLLL基底簡約，BKZ基底簡約など多くの基底簡約アルゴリズムはLLL基底簡約の一般化として定義される．
            LLL基底簡約によって簡約された格子基底を<b>LLL簡約基底</b>などと呼ぶ．
        </p>

        <div class="wiki-toc">
            <strong>目次</strong>
            <ul>
                <li><a href="#definition">定義</a></li>
                <ul>
                    <li><a href="#iff-rwr">Lovász条件の同値な書き換え</a></li>
                </ul>
                <li><a href="#property">性質</a></li>
                <ul>
                    <li><a href="#upperbounds">LLL簡約基底の上界</a></li>
                    <li><a href="#od-upperbounds">直交性欠陥の上界</a></li>
                </ul>
                <li><a href="#algorithm">LLL基底簡約アルゴリズム</a></li>
                <li><a href="#implementation">実装</a></li>
                <li><a href="#reference">出典</a></li>
                <li><a href="#citation">参考文献</a></li>
            </ul>
        </div>

        <h2 id="definition">定義</h2>
        <p>
            \(\{\bm{b}_1,\ldots,\bm{b}_n\}\)を\(n\)次元格子\(L\subseteq \R^m\)の基底とする．
            このとき，基底が簡約パラメタ\(\frac{1}{4} < \delta < 1\)について<b>LLL簡約</b>されているとは，
                $$
                \begin{aligned}
                & (i) & & 1\le \forall j < \forall i\le n\left(\abs{\mu_{i, j}}\le\frac{1}{2}\right)\\ & (ii) & & 2\le
                    \forall k\le n \left(\delta\cdot \norm{\bm{b}_{k-1}^\star}^2\le\norm{\pi_{k-1}(\bm{b}_k)}^2\right)
                    \end{aligned} $$ の二条件を満足するときをいう． 但し， <div class="scroll-container">
                    $$
                    \left\{
                    \begin{aligned}
                    & \pi_\ell : \R^n \longrightarrow \langle \bm{b}_1, \dots, \bm{b}_{\ell-1} \rangle_\mathbb{R}^\perp
                    =
                    \langle \bm{b}_\ell^\star, \dots, \bm{b}_n^\star \rangle_\R, \\
                    & \pi_\ell(\bm{x}) := \sum_{i = \ell}^n \frac{\langle \bm{x}, \bm{b}_i^\star
                    \rangle}{\norm{\bm{b}_i^\star}^2}
                    \bm{b}_i^\star
                    \end{aligned}
                    \right.
                    $$
                    </div>
                    は\(\langle \bm{b}_1, \dots, \bm{b}_{\ell-1} \rangle_\mathbb{R}\)の直交補空間への直交射影とする．
                    特に条件(i)を<b>サイズ簡約条件</b>，条件(ii)を<b>Lovász条件</b>（<b>Lovász condition</b>）や<b>exchange条件</b>（<b>exchange
                        condition</b>）と呼ぶ．
        </p>

        <h3 id="iff-rwr">Lovász条件の同値な書き換え</h3>

        <p>
            Lovász条件は
        <div class="scroll-container">
            $$
            2\le \forall k\le n\left(\norm{\bm{b}_k^\star}^2\ge \left(\delta-\mu_{k,
            k-1}^2\right)\norm{\bm{b}_{k-1}^\star}^2\right)
            $$
        </div>
        と同値であることが簡単な計算からすぐに分かる．
        このことから，この条件式を<b>Lovász条件</b>と呼ぶことも少なくない．
        </p>

        <h2 id="property">性質</h2>

        <h3 id="upperbounds">LLL簡約基底の上界</h3>

        <div class="math-block theorem">
            <span class="math-label" id="LLLtheorem">定理（Lenstra, Lenstra, and Lovász
                <sup id="cite_ref-1" class="reference">
                    <a href="#ref-1">[1]</a>
                </sup>
                ）</span>
            <p>
                \(n\)次元格子\(L\)の基底\(\{\bm{b}_1,\ldots,\bm{b}_n\}\)は\(\frac{1}{4}<\delta<
                    1\)に対してLLL簡約されているとし，\(\alpha:=\frac{4}{4\delta-1}\)とする． このとき <div class="scroll-container">
                    $$
                    \begin{aligned}
                    & (i) & & 1\le \forall j\le \forall i\le
                    n\left(\norm{\bm{b}_j^\star}^2\le\alpha^{i-j}\norm{\bm{b}_j^\star}^2\right)\\
                    & (ii) & & \norm{\bm{b}_1}\le\alpha^{\frac{n-1}{4}}\vol{L}^{\frac{1}{n}}\\
                    & (iii) & & 1 \le \forall i\le n\left(\norm{\bm{b}_i}\le\alpha^\frac{n-1}{2}\lambda_i(L)\right)\\
                    & (iv) & & \prod_{i=1}^n\norm{\bm{b}_i}\le \alpha^\frac{n(n-1)}{4}\vol{L}
                    \end{aligned}
                    $$
        </div>
        が成立する．
        </p>
        </div>

        <details class="wiki-proof">
            <summary>証明</summary>
            <div class="proof">
                <p>
                    (i) 定義から，任意の\(2\le k\le n\)に対して
                    $$
                    \norm{\bm{b}_k^\star}^2\ge \left(\delta-\mu_{k, k-1}^2\right)\norm{\bm{b}_{k-1}^\star}^2\ge
                    \left(\delta-\frac{1}{4}\right)\norm{\bm{b}_{k-1}^\star}^2
                    $$
                    が成立する．
                    従って任意の\(1\le j\le i\le n\)に対して，
                    $$
                    \norm{\bm{b}_j^\star}^2\le\alpha\norm{\bm{b}_{j+1}^\star}^2\le\cdots\le\alpha^{i-j}\norm{\bm{b}_i^\star}^2
                    $$
                    が成立する．<br>
                    (ii) (i)より
                    $$
                    1\le \forall i\le n\left(\norm{\bm{b}_1}^2\le\alpha^{i-1}\norm{\bm{b}_i^\star}^2\right)
                    $$
                    が従う．
                    これを全ての\(1\le i\le n\)で掛け合わせて
                    $$
                    \norm{\bm{b}_1}^{2n}\le\prod_{i=1}^n\alpha^{i-1}\norm{\bm{b}_i^\star}^2=\alpha^{\frac{n(n-1)}{2}}\vol{L}^2
                    $$
                    を得る．<br>
                    (iii) (i)より，任意の\(1\le i\le n\)に対して
                    $$
                    \begin{aligned}
                    \norm{\bm{b}_i}^2&\le\norm{\bm{b}_i^\star}^2+\frac{1}{4}\sum_{j=1}^{i-1}\norm{\bm{b}_j^\star}^2\\
                    &\le\norm{\bm{b}_i^\star}^2+\frac{1}{4}\sum_{j=1}^{i-1}\alpha^{i-j}\norm{\bm{b}_i^\star}^2\\
                    &=\left\{1+\frac{\alpha^i-\alpha}{4(\alpha-1)}\right\}\norm{\bm{b}_i^\star}^2
                    \end{aligned}
                    $$
                    が成立する．
                    他方で，定義から\(\frac{\alpha}{4(\alpha-1)}\le 1\)であるので
                    $$
                    \frac{\alpha^i-\alpha}{4(\alpha-1)}=\frac{\alpha(\alpha^{i-1}-1)}{4(\alpha-1)}\le \alpha^{i-1}-1
                    $$
                    が成立するので，
                    $$
                    1+\frac{\alpha^i-\alpha}{4(\alpha-1)}\le\alpha^{i-1}
                    $$
                    であり，従って
                    $$
                    \norm{\bm{b}_i}^2\le\alpha^{i-1}\norm{\bm{b}_i^\star}^2
                    $$
                    である．
                    更に(i)より
                    $$
                    \norm{\bm{b}_i}^2\le\alpha^{i-1}\norm{\bm{b}_i^\star}^2\le\alpha^{i-1}\alpha^{k-i}\norm{\bm{b}_k^\star}^2\le\alpha^{n-1}\norm{\bm{b}_k^\star}^2
                    $$
                    が任意の\(i\le k\le n\)に対して成立する．よって
                    $$
                    \norm{\bm{b}_i}\le\alpha^\frac{n-1}{2}\min\{\norm{\bm{b}_i^\star},\ldots,\norm{\bm{b}_n^\star}\}\le\alpha^{\frac{n-1}{2}}\lambda_i(L).
                    $$
                    <br>
                    (iv) 先に登場した式\(\norm{\bm{b}_i}^2\le\alpha^{i-1}\norm{\bm{b}_i^\star}^2\)を全ての\(1\le i\le n\)で掛け合わせて
                    $$
                    \prod_{i=1}^n\norm{\bm{b}_i}^2\le\left(\prod_{i=1}^n\alpha^{i-1}\right)\vol{L}^2=\alpha^{\frac{n(n-1)}{2}}\vol(L)^2
                    $$
                    を得る．
                </p>
            </div>
        </details>

        <h3 id="od-upperbounds">直交性欠陥の上界</h3>

        基底の<a href="orthogonality-defect.html" class="wiki-term" data-desc="格子基底の品質を表す指標の一つ．">直交性欠陥</a>は，格子の<a
            href="volume.html" class="wiki-term" data-desc="格子の不変量の一つ．">体積</a>
        \(\vol{L}\)を用いて
        $$
        \od{\bm{b}_1,\ldots,\bm{b}_n}:=\frac{\prod_{i=1}^n \norm{\bm{b}_i}}{\vol{L}}
        $$
        と定義される量であった．

        <div class="math-block theorem">
            <span class="math-label">命題</span>
            <p>
                \(\{\bm{b}_1,\ldots,\bm{b}_n\}\)を\(n\)次元格子\(L\subseteq \R^m\)の基底とし，簡約パラメタ\(\frac{1}{4} < \delta <
                    1\)についてLLL簡約されているとする． このとき，\(\alpha :=\frac{4}{4\delta -1}\)とすると， $$
                    \od{\bm{b}_1,\ldots,\bm{b}_n}\le \alpha^{\frac{n(n-1)}{4}} $$ が成立する． </p>
        </div>

        <details class="wiki-proof">
            <summary>証明</summary>
            <div class="proof">
                <p>
                    Lenstra-Lenstra-Lovászの定理<sup id="cite_ref-1" class="reference"><a href="#ref-1">[1]</a></sup>から
                <div class="scroll-container">
                    $$
                    \od{\bm{b}_1,\ldots,\bm{b}_n}\le
                    \frac{\alpha^{\frac{n(n-1)}{4}}\vol{L}}{\vol{L}}=\alpha^{\frac{n(n-1)}{4}}
                    $$
                </div>
                を得る．
                </p>
            </div>
        </details>

        <h2 id="algorithm">LLL基底簡約アルゴリズム</h2>

        <div class="algorithm-box">
            <span class="algorithm-caption">アルゴリズム 1: LLL基底簡約アルゴリズム
                <sup id="cite_ref-2" class="reference">
                    <a href="#ref-2">[2]</a>
                </sup>
                <sup id="cite_ref-3" class="reference">
                    <a href="#ref-3">[3]</a>
                </sup>
            </span>
            <code>
<span class="kw">Input:</span> 基底 b=[b[1],..., b[n]], 簡約パラメタ delta
<span class="kw">Output:</span> LLL簡約基底 b

<span class="kw">function</span> <span class="fn">LLL</span>(b, delta)
    bs[1], ..., bs[n], mu <- <span class="fn">gram_schmidt</span>(b)
    k <- 2
    <span class="kw">while</span> k <= n <span class="kw">do</span>
        <span class="kw">for</span> j = 1 to k - 1 <span class="kw">do</span>
            <span class="kw">if</span> <span class="fn">abs</span>(mu[k, j]) > 0.5 <span class="kw">then</span>
                b[k] <- b[k] - <span class="fn">round</span>(mu[k, j]) * b[j]
                Updates GSO
            <span class="kw">end if</span>
        <span class="kw">end for</span>
        <span class="kw">if</span> k > 0 and <span class="fn">norm</span>(bs[k])^2 < (delta - mu[k, k-1]^2) * <span class="fn">norm</span>(bs[k-1])^2 <span class="kw">then</span>
            swap b[k] and b[k - 1]
            Updates GSO
            k <- k - 1
        <span class="kw">else</span>
            k <- k + 1
        <span class="kw">end if</span>
    <span class="kw">end while</span>
    <span class="kw">return</span> b
<span class="kw">end function</span>
    </code>
        </div>

        <h2 id="implementation">実装</h2>

        LLL基底簡約アルゴリズムは，例えば以下の言語，ソフトウェア，ライブラリで実装されている．
        尚，以下のリストは飽くまで一例であり，全ての実装を一覧しているわけではないことに注意されたい．

        <h3>言語での実装</h3>

        <ul>
            <li><a href="https://pari.math.u-bordeaux.fr">PARI/GP</a>：<code>qflll</code>函数によりLLL簡約を行うことができる．</li>
            <li><a href="https://www.sagemath.org">SageMath</a>：<code>LLL</code>メソッドを呼び出すことでLLL簡約をすることができる．</li>
        </ul>

        <h3>ソフトウェアでの実装</h3>

        <ul>
            <li><a href="https://magma.maths.usyd.edu.au/magma/">Magma</a>：<code>LLL</code>函数によりLLL簡約を行うことができる．</li>
            <li><a href="https://github.com/satoshin-des/LatBlue">LatBlue</a>：<code>LLL</code>によりLLL簡約を行うことができる．</li>
        </ul>

        <h3>ライブラリでの実装</h3>

        <ul>
            <li><a href="https://github.com/fplll/fplll">fplll</a></li>
            <li><a href="https://github.com/satoshin-des/glatl">glatl</a>：<code>LLL</code>函数によりLLL簡約を行うことができる．</li>
            <li><a
                    href="https://github.com/satoshin-des/liblat">liblat</a>：<code>LLL</code>函数，及び<code>L2</code>函数によりLLL簡約を行うことができる．
            </li>
            <li><a
                    href="https://github.com/libntl/ntl">NTL</a>：<code>LLL</code>，<code>LLL_FP</code>，<code>LLL_QQ</code>などの函数によりLLL簡約を行うことができる．
            </li>
            <li><a href="https://github.com/orisano/olll">olll</a>：<code>reduction</code>函数によりLLL簡約を行うことができる．</li>
        </ul>

        <section class="wiki-references-section">
            <h2 id="reference">出典</h2>
            <ol class="wiki-references-list">
                <li id="ref-1">
                    <span class="reference-text">
                        Lenstra, Lenstra, and Lovász 1982, Proposition (1.6).
                    </span>
                    <a href="#cite_ref-1" class="back-to-text" title="本文に戻る">^</a>
                </li>
                <li id="ref-2">
                    <span class="reference-text">
                        Lenstra, Lenstra, and Lovász 1982, Fig. 1.
                    </span>
                    <a href="#cite_ref-2" class="back-to-text" title="本文に戻る">^</a>
                </li>
                <li id="ref-3">
                    <span class="reference-text">
                        Bottesch, Haslbeck, and Thiemann 2018, Algorithm 1
                    </span>
                    <a href="#cite_ref-3" class="back-to-text" title="本文に戻る">^</a>
                </li>
            </ol>
        </section>

        <h2 id="citation">参考文献</h2>

        <ul>
            <li>
                <span class="reference-text">
                    Murray R. Bremner(2012).
                    <i>Lattice Basis Reduction An Introduction to the LLL Algorithm and Its
                        Applications</i>.
                    Chapman & Hall Pure and Applied Mathematics.
                    ISBN: 978-1439807026
                </span>
            </li>
            <li>
                <span class="reference-text">
                    青野良範，安田雅哉
                    『格子暗号解読のための数学的基礎』，
                    2019年．
                    ISBN 978-4764905986
                </span>
            </li>
            <li>
                <span class="reference-text">
                    A. K. Lenstra, H. W. Lenstra, and L. Lovász(1982).
                    <i>Factoring polynomials with rational coefficients</i>.
                    Mathematische Annalen.
                    doi: 10.1007/BF01457454
                </span>
            </li>
            <li>
                <span class="reference-text">
                    Ralph Bottesch, Max W. Haslbeck, and René Thiemann(2018).
                    <i>A verified efficient implementation of the LLL basis reduction algorithm</i>.
                    LPAR-22.
                    doi: 10.29007/xwwh
                </span>
            </li>
        </ul>
    </article>

    <footer></footer>
    <script src="footer.js"></script>

    <script src="script.js"></script>
    <script src="search.js"></script>
</body>

</html>