<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ポテンシャル</title>
    <style>
        @import url(../style.css);
    </style>
    <script src="../macros.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <header></header>
    <script src="../header.js"></script>
    <article class="wiki-content">
        <h1>ポテンシャル</h1>
        <p>
            格子基底の<b>ポテンシャル</b>は，格子基底の品質を表す指標の一つである．
            元は，LLL基底簡約アルゴリズムの停止性を証明するために導入された量である
            <sup id="cite_ref-2" class="reference">
                <a href="#ref-2">[2]</a>
            </sup>
            ．
            また，<b>loop invariant</b>と呼ばれることもある
            <sup id="cite_ref-3" class="reference">
                <a href="#ref-3">[3]</a>
            </sup>
            ．
        </p>

        <div class="wiki-toc">
            <strong>目次</strong>
            <ul>
                <li><a href="#definition">定義</a></li>
                <li><a href="#property">性質</a></li>
                <li><a href="#example">具体例</a></li>
                <li><a href="#reference">参考文献</a></li>
            </ul>
        </div>

        <h2 id="definition">定義</h2>
        <p>
            \(n\)次元格子\(L\subseteq \mathbb{R}^m\)の基底\(\lbrace\bm{b}_1, \ldots, \bm{b}_n\rbrace\)に対して，基底の<b>ポテンシャル</b>は
            $$\Pot{\bm{b}_1, \ldots, \bm{b}_n}=\prod_{i=1}^n \mathrm{vol}(L_i)^2$$
            と定義される．但し，\(L_i\)は\(\lbrace\bm{b}_1, \ldots, \bm{b}_i\rbrace\)を基底に持つ\(L\)の部分格子である．
        </p>
        <p>
            \(L_i\)の基底\(\lbrace\bm{b}_1, \ldots, \bm{b}_i\rbrace\)のGSOベクトルは\(\bm{b}_1^\star, \ldots,
            \bm{b}_i^\star\)であるため，\(L_i\)の体積は
            $$\vol{L}=\prod_{j=1}^i \norm{\bm{b}_j^\star}$$
            と書ける．従って，基底のポテンシャルは以下の様に書き換えることができる：
            $$\Pot{\bm{b}_1, \ldots, \bm{b}_n}=\prod_{i=1}^n \prod_{j=1}^i
            \norm{\bm{b}_j^\star}^2=\prod_{j=1}^n\norm{\bm{b}_j^\star}^{2(n-j+1)}$$
        </p>

        <h2 id="property">性質</h2>

        <h3>GSAスロープの傾きとの関係</h3>

        <p>
            GSAスロープの傾きもポテンシャル同様，格子基底の品質を表す指標の一つである．
            GSAスロープの傾きと基底のポテンシャルとの間には，次の関係が成立することが知られている
            <sup id="cite_ref-1" class="reference">
                <a href="#ref-1">[1]</a>
            </sup>
            ．
        </p>
        <div class="scroll-container">
            <div class="math-block theorem">
                <span class="math-label">命題</span>
                <p>
                    \(\lbrace\bm{b}_1, \ldots, \bm{b}_n\rbrace\)を\(n\)次元格子\(L\subseteq \mathbb{R}^m\)の基底とする．
                    このとき，
                    $$\log \Pot{\bm{b}_1, \ldots, \bm{b}_n}+\binom{n+1}{3}\slope{\bm{b}_1, \ldots, \bm{b}_n}=(n+1)\log
                    \vol{L}$$
                    が成立する．
                </p>
            </div>
        </div>
        <details class="wiki-proof">
            <summary>証明</summary>
            <div class="proof">
                <p>
                    \(\bm{b}_1^\star,\ldots, \bm{b}_n^\star\)を\(\lbrace\bm{b}_1, \ldots, \bm{b}_n\rbrace\)のGSOベクトルとする．
                    定義から
                <div class="scroll-container">
                    $$
                    \begin{aligned}
                    \log \Pot{\bm{b}_1, \ldots, \bm{b}_n}&=\log \prod_{i=1}^n \norm{\bm{b}_i^\star}^{2(n-i+1)}\\
                    &=2\sum_{i=1}^n (n-i+1)\log \norm{\bm{b}_i^\star}\\
                    &=2(n+1)\sum_{i=1}^n \log \norm{\bm{b}_i^\star}-2\sum_{i=1}^n i\log \norm{\bm{b}_i^\star}\\
                    &=2(n+1) \log\vol{L}-2\sum_{i=1}^n i\log \norm{\bm{b}_i^\star}
                    \end{aligned}
                    $$
                </div>
                がわかる．
                更に，GSAスロープの傾きの定義から
                <div class="scroll-container">
                    $$
                    \begin{aligned}
                    \slope{\bm{b}_1,\ldots,\bm{b}_n}&=\frac{3}{n(n^2-1)}\log \prod_{i=1}^n \prod_{j=1}^i
                    \frac{\norm{\bm{b}_i^\star}^2}{\norm{\bm{b}_j^\star}^2}\\
                    &=\frac{6}{n(n^2-1)}\sum_{i=1}^n \sum_{j=1}^i \log
                    \frac{\norm{\bm{b}_i^\star}^2}{\norm{\bm{b}_j^\star}^2}\\
                    &=\frac{6}{n(n^2-1)}\left(\sum_{i=1}^n i\log \norm{\bm{b}_i^\star}-\sum_{i=1}^n \sum_{j=1}^i \log
                    \norm{\bm{b}_j^\star}\right)\\
                    &=\frac{6}{n(n^2-1)}\sum_{i=1}^n i\log \norm{\bm{b}_i^\star}-\frac{3}{n(n^2-1)}\log
                    \Pot{\bm{b}_1,\ldots,\bm{b}_n}
                    \end{aligned}
                    $$
                </div>
                がわかる．
                従って，
                <div class="scroll-container">
                    $$
                    \begin{aligned}
                    &\frac{n(n^2-1)}{6}\slope{\bm{b}_1,\ldots,\bm{b}_n}=\sum_{i=1}^n i\log
                    \norm{\bm{b}_i^\star}-\frac{1}{2}\log \Pot{\bm{b}_1,\ldots,\bm{b}_n}\\
                    \iff& \binom{n+1}{3}\slope{\bm{b}_1,\ldots,\bm{b}_n}=(n+1)\log \vol{L}-\log
                    \Pot{\bm{b}_1,\ldots,\bm{b}_n}\\
                    \iff&\log \Pot{\bm{b}_1, \ldots, \bm{b}_n}+\binom{n+1}{3}\slope{\bm{b}_1, \ldots,
                    \bm{b}_n}=(n+1)\log
                    \vol{L}
                    \end{aligned}
                    $$
                </div>
                となる．
                </p>
            </div>
        </details>

        <h3>ポテンシャルが整数となる十分条件</h3>

        <div class="scroll-container">
            <div class="math-block theorem">
                <span class="math-label">命題</span>
                <p>
                    \(\lbrace\bm{b}_1, \ldots, \bm{b}_n\rbrace\)を\(n\)次元格子\(L\subseteq \mathbb{R}^m\)の基底とする．
                    このとき，基底行列\(\bm{B}\)が\(\bm{B}\bm{B}^\top\in \Z^n\)を満たすとき，基底のポテンシャルは整数になる．
                </p>
            </div>
        </div>
        <details class="wiki-proof">
            <summary>証明</summary>
            <div class="proof">
                <p>
                    仮定から，任意の\(1\le i, j\le n\)に対して\(\inner{\bm{b}_i, \bm{b}_j}\in \Z\)が成立する．
                    従って，格子の体積の定義から，任意の\(1\le i\le n\)に対して
                    $$
                    \vol{L_i}^2=\left(\det \begin{bmatrix}
                    \inner{\bm{b}_1, \bm{b}_1} & \cdots & \inner{\bm{b}_1, \bm{b}_i}\\
                    \vdots & \ddots & \vdots\\
                    \inner{\bm{b}_i, \bm{b}_1} & \cdots & \inner{\bm{b}_i, \bm{b}_i}
                    \end{bmatrix}\right)^2\in \Z
                    $$
                    が成立する．
                    従って，ポテンシャルは整数である．
                </p>
            </div>
        </details>

        <h2 id="example">具体例</h2>

        <p>
            次の格子基底行列\(\bm{B}\)で生成される格子\(L\)を考える：
            $$
            \begin{aligned}
            \bm{B}:= \begin{bmatrix}
            100 & 0 & 0\\
            101 & 1 & 0\\
            102 & 0 & 1
            \end{bmatrix}.
            \end{aligned}
            $$
            このとき，GSOベクトル\(\bm{b}_1^\star,\bm{b}_2^\star, \bm{b}_3^\star\)は，それぞれ
        <div class="scroll-container">
            $$
            \bm{b}_1^\star=(100, 0, 0), \bm{b}_2^\star=(0, 1, 0), \bm{b}_3^\star=(0, 0, 1)
            $$
        </div>
        である．
        従って，
        $$
        \begin{aligned}
        \Pot{\bm{B}}&=\prod_{j=1}^n\norm{\bm{b}_j^\star}^{2(n-j+1)}\\
        &=100^{6}\times 1 \times 1=10^{12}
        \end{aligned}
        $$
        である．
        </p>

        <h2>ポテンシャルを利用したLLLアルゴリズムの停止性の証明</h2>

        <p>
            \(n\)次元格子\(L\)の基底\(\{\bm{b}_1,\ldots,\bm{b}_n\}\)が<b>LLL基底簡約されている</b>とは，以下の2条件を満足することであった．
        <ul>
            <li>\(1\le \forall j < \forall i\le n\left(\abs{\mu_{i, j}}\le \frac{1}{2}\right)\)</li>
            <li>\(2 \le \forall k \le n\left(\delta \norm{\bm{b}_{k-1}^\star}^2 \le
                \norm{\pi_{k-1}(\bm{b}_k)}^2\right)\)</li>
        </ul>
        但し，\(\bm{b}_1^\star,\ldots, \bm{b}_n^\star\)は基底\(\{\bm{b}_1,\ldots,\bm{b}_n\}\)のGSOベクトル，\(\bm{U}=(\mu_{i,
        j})_{1\le i, j\le n}\)はGSO係数行列，
        $$
        \left\{
        \begin{aligned}
        & \pi_\ell : \R^n \longrightarrow \langle \bm{b}_1, \dots, \bm{b}_{\ell-1} \rangle_\mathbb{R}^\perp =
        \langle \bm{b}_\ell^\star, \dots, \bm{b}_n^\star \rangle_\R, \\
        & \pi_\ell(\bm{x}) := \sum_{i = \ell}^n \frac{\langle \bm{x}, \bm{b}_i^\star \rangle}{\norm{\bm{b}_i^\star}^2}
        \bm{b}_i^\star
        \end{aligned}
        \right.
        $$
        は\(\langle \bm{b}_1, \dots, \bm{b}_{\ell-1} \rangle_\mathbb{R}\)の直交補空間への直交射影とする．<br>
        \(1\le i\le n\)に対して，\(B_i:=\norm{\bm{b}_i^\star}^2\)，\(X:=\max_{1\le i\le n}B_i\)とおく．
        $$
        0<\Pot{\bm{b}_1,\ldots, \bm{b}_n}=\prod_{i=1}^n \prod_{j=1}^i B_j\le X^{\frac{n(n+1)}{2}}
        $$
        が成立する．
        サイズ基底簡約によってGSOベクトルは変化しないため，基底ベクトルの交換によるポテンシャルの値の変化を考える．
        隣り合う基底ベクトル\(\bm{b}_{\ell-1}\)，\(\bm{b}_\ell\)の交換によって得られる新しい基底を\(\{\bm{c}_1,\ldots,\bm{c}_n\}\)とおく：
        $$
        \{\bm{c}_1,\ldots,\bm{c}_n\}:=\{\bm{b}_1,\ldots,\bm{b}_{\ell-2},\bm{b}_\ell, \bm{b}_{\ell-1},
        \bm{b}_{\ell+1},\ldots,\bm{b}_n\}.
        $$
        新しい基底ベクトルのGSOベクトルを\(\bm{c}_1^\star,\ldots,\bm{c}_n^\star\)とし，その2乗ノルムを\(C_i=\norm{\bm{c}_i^\star}^2\)とおく．
        このとき，次が成立することが知られている．
        <div class="scroll-container">
            <div class="math-block theorem">
                <span class="math-label">定理</span>
                <p>
                    $$
                    C_j=\left\{
                    \begin{aligned}
                    &B_j & 1\le j\le i-1 \lor i+2\le j\le n\\
                    &\norm{\pi_{i}(\bm{b}_{i+1})}^2 & j=i\\
                    &\frac{B_{i+1}}{\norm{\pi_{i}(\bm{b}_{i+1})}^2}B_i & j=i+1
                    \end{aligned}
                    \right.
                    $$
                </p>
            </div>
        </div>
        従って，
        <div class="scroll-container">
            $$
            \begin{aligned}
            \Pot{\bm{c}_1,\ldots, \bm{c}_n}&=\prod_{j=1}^{i-1} B_j^{n-j+1}\times C_i^{i}\times C_{i+1}^{i+1}\times \prod_{j=i+2}^n B_j^{n-j+1}\\
            &=\prod_{j=1}^{i-1} B_j^{n-j+1}\times {\norm{\pi_{i}(\bm{b}_{i+1})}^{2i}}\times \frac{B_{i+1}^{i+1}}{\norm{\pi_{i}(\bm{b}_{i+1})}^{2(i+1)}}B_i^{i+1}\times \prod_{j=i+2}^n B_j^{n-j+1}\\
            &=\prod_{j=1}^{i-1} B_j^{n-j+1}\times \frac{B_i^{i+1}B_{i+1}^{i+1}}{\norm{\pi_{i}(\bm{b}_{i+1})}^{2}}\times \prod_{j=i+2}^n B_j^{n-j+1}\\
            &=\frac{B_i}{\norm{\pi_{i}(\bm{b}_{i+1})}^{2}} \prod_{j=1}^n B_j^{n-j+1}\\
            &< \delta \Pot{\bm{b}_1,\ldots, \bm{b}_n}
            \end{aligned}
            $$
        </div>
        となる．
        即ち，基底のポテンシャルはLovász条件を満足しない基底の入れ替えによって少なくとも\(\delta\)倍ずつ単調減少するため有限回で停止する．
        </p>

        <section class="wiki-references-section">
            <h2 id="reference">参考文献</h2>
            <ol class="wiki-references-list">
                <li id="ref-1">
                    <span class="reference-text">
                        Léo Ducas1, Ludo N. Pulles, and Marc Stevens(2025).
                        <i>Towards a Modern LLL Implementation</i>.
                        Cryptology ePrint Archive, Paper 2025/774.
                        doi: 10.1007/978-981-95-5099-9_3
                    </span>
                    <a href="#cite_ref-1" class="back-to-text" title="本文に戻る">^</a>
                </li>
                <li id="ref-2">
                    <span class="reference-text">
                        A. K. Lenstra, H. W. Lenstra, and L. Lovász(1982).
                        <i>Factoring polynomials with rational coefficients</i>.
                        Mathematische Annalen.
                        doi: 10.1007/BF01457454
                    </span>
                    <a href="#cite_ref-2" class="back-to-text" title="本文に戻る">^</a>
                </li>
                <li id="ref-3">
                    <span class="reference-text">
                        Murray R. Bremner(2012).
                        <i>Lattice Basis Reduction An Introduction to the LLL Algorithm and Its Applications</i>.
                        Chapman & Hall Pure and Applied Mathematics.
                        ISBN: 978-1439807026
                    </span>
                    <a href="#cite_ref-3" class="back-to-text" title="本文に戻る">^</a>
                </li>
            </ol>
        </section>
    </article>

    <footer></footer>
    <script src="../footer.js"></script>

    <script src="../script.js"></script>
</body>

</html>